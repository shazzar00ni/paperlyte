
<!DOCTYPE html>
<html lang="en">
  <body>
    <script>
      (async () => {
        if (!navigator.serviceWorker)
          throw new Error(`Service workers are not supported.\nMake sure to serve the Trace Viewer (${window.location}) via HTTPS or localhost.`);
        navigator.serviceWorker.register('sw.bundle.js');
        if (!navigator.serviceWorker.controller)
          await new Promise(f => navigator.serviceWorker.oncontrollerchange = f);
        const traceUrl = new URL(location.href).searchParams.get('trace');
        if (!traceUrl) {
          console.error('Missing "trace" parameter in snapshot URL:', location.href);
          return;
        }
        const params = new URLSearchParams();
        params.set('trace', traceUrl);
        await fetch('contexts?' + params.toString()).then(r => r.json());
        location.reload();
      })();
    </script>
    <script src="stall.js"></script>
  </body>
</html>
